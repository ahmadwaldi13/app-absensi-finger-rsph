
SELECT
    id_user,
    date(waktu) tgl_presensi
    ,GROUP_CONCAT( time(waktu) ORDER BY UNIX_TIMESTAMP( time(waktu) ) ASC ) AS presensi
FROM
    ref_data_absensi_tmp 
WHERE
    date( waktu ) BETWEEN "2023-06-01" AND "2023-06-30"
GROUP BY id_user,UNIX_TIMESTAMP( date(waktu) )
ORDER BY UNIX_TIMESTAMP( date(waktu) ) ASC


select 
    id_user,
    JSON_ARRAYAGG(
	    JSON_OBJECT('tgl', tanggal, 'presensi', presen  )
    ) AS data_array,
	JSON_ARRAYAGG(
	    JSON_OBJECT(tanggal, presen  )
    ) AS data_index
from (
	SELECT
		id_user,
		date(waktu) tanggal,
		GROUP_CONCAT( time(waktu) ORDER BY UNIX_TIMESTAMP( time(waktu) ) ASC ) presen
	FROM
		ref_data_absensi_tmp 
	WHERE
		date( waktu ) BETWEEN "2023-06-01" AND "2023-06-30"
	GROUP BY id_user,UNIX_TIMESTAMP( date(waktu) )
    ORDER BY id_user ASC,UNIX_TIMESTAMP( date(waktu) ) ASC
)utama
GROUP BY id_user
